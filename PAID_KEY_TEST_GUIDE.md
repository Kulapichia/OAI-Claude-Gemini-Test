# 付费Key检测功能测试指南

## 测试目标
验证修改后的付费检测逻辑是否满足要求：
- **valid: true** = 免费key（显示为有效key）
- **isPaid: true** = 付费key

## 测试环境准备

### 1. 启动应用
```bash
cd e:\AAA_Program\keychecher-react\api-key-tester
npm start
```

### 2. 准备测试数据
需要准备以下类型的Gemini API Key：
- **免费Key**: 有效但只能访问基础API的key
- **付费Key**: 可以访问Cache API的key  
- **无效Key**: 格式错误或已失效的key

## 核心功能测试

### 测试1: 免费Key检测
**期望结果**: `status: 'valid'`, `isPaid: false`

**测试步骤**:
1. 选择API类型为"Gemini"
2. 开启"开启付费key检测"开关
3. 输入免费Gemini API Key
4. 点击"开始测试"

**验证点**:
- [ ] Key状态显示为"有效Key"（绿色）
- [ ] Key出现在"有效"标签页中
- [ ] Key不出现在"付费"标签页中
- [ ] 显示"🆓 免费"标识

### 测试2: 付费Key检测
**期望结果**: `status: 'paid'`, `isPaid: true`

**测试步骤**:
1. 选择API类型为"Gemini"
2. 开启"开启付费key检测"开关
3. 输入付费Gemini API Key
4. 点击"开始测试"

**验证点**:
- [ ] Key状态显示为"付费Key"（红色）
- [ ] Key出现在"付费"标签页中
- [ ] Key不出现在"有效"标签页中
- [ ] 显示"💎 付费"标识

### 测试3: 无效Key检测
**期望结果**: `status: 'invalid'`, `isPaid: null`

**测试步骤**:
1. 选择API类型为"Gemini"
2. 开启"开启付费key检测"开关
3. 输入无效的API Key
4. 点击"开始测试"

**验证点**:
- [ ] Key状态显示为"无效Key"（红色）
- [ ] Key出现在"无效"标签页中
- [ ] Key不出现在其他标签页中
- [ ] 显示错误信息

### 测试4: 未开启付费检测
**期望结果**: 只进行基础检测，无付费状态

**测试步骤**:
1. 选择API类型为"Gemini"
2. 关闭"开启付费key检测"开关
3. 输入任意有效Gemini API Key
4. 点击"开始测试"

**验证点**:
- [ ] Key状态显示为"有效Key"
- [ ] 没有付费/免费标识
- [ ] 没有"付费"标签页
- [ ] 检测速度更快（只调用一次API）

## UI界面测试

### 测试5: 标签页筛选功能
**测试步骤**:
1. 测试包含免费、付费、无效key的混合列表
2. 点击不同标签页

**验证点**:
- [ ] "全部"标签页显示所有key
- [ ] "有效"标签页只显示免费key（status='valid'）
- [ ] "付费"标签页只显示付费key（status='paid'）
- [ ] "无效"标签页只显示无效key
- [ ] "速率限制"标签页只显示被限制的key

### 测试6: 视觉样式验证
**验证点**:
- [ ] 免费key: 绿色"有效Key"状态，蓝色"🆓 免费"标识
- [ ] 付费key: 红色"付费Key"状态，红色"💎 付费"标识
- [ ] 无效key: 红色"无效Key"状态
- [ ] 深色主题下样式正确显示

### 测试7: 复制功能测试
**验证点**:
- [ ] "复制有效Keys"按钮只复制免费key
- [ ] "复制付费Keys"按钮只复制付费key（如果存在）
- [ ] "复制所有Keys"按钮复制所有key

## 性能测试

### 测试8: 批量检测
**测试步骤**:
1. 输入10个混合类型的key
2. 开启付费检测
3. 观察检测过程

**验证点**:
- [ ] 每个key都经过两阶段检测
- [ ] 状态更新及时准确
- [ ] 无内存泄漏或卡顿
- [ ] 错误处理正确

## 边界情况测试

### 测试9: 网络异常处理
**测试场景**:
- Cache API调用超时
- Cache API返回非标准错误码
- 网络连接中断

**验证点**:
- [ ] 异常时默认为免费key
- [ ] 显示适当的错误信息
- [ ] 不影响基础检测结果

### 测试10: API配置测试
**测试步骤**:
1. 测试不同的代理设置
2. 测试不同的模型选择

**验证点**:
- [ ] 代理设置不影响付费检测
- [ ] 付费检测固定使用gemini-2.5-flash模型
- [ ] 配置变更后检测逻辑正确

## 回归测试

### 测试11: 非Gemini API类型
**验证点**:
- [ ] OpenAI和Claude不显示付费检测选项
- [ ] 切换API类型时付费检测选项正确显示/隐藏

### 测试12: 基础功能不受影响
**验证点**:
- [ ] 基础key验证功能正常
- [ ] 统计数据正确计算
- [ ] 导出功能正常工作
- [ ] 多语言切换正常

## 测试用例示例

### 示例Key（仅供测试格式参考）
```
# 免费Key示例格式
AIzaSyFreeKey123456789012345678901234

# 付费Key示例格式  
AIzaSyPaidKey123456789012345678901234

# 无效Key示例
InvalidKey123
AIzaSyInvalidFormat
```

## 测试结果记录

### 功能测试结果
- [ ] 免费Key正确识别为有效Key
- [ ] 付费Key正确识别为付费Key
- [ ] 无效Key正确识别为无效Key
- [ ] 标签页筛选功能正确
- [ ] UI样式显示正确

### 性能测试结果
- [ ] 批量检测性能良好
- [ ] 内存使用正常
- [ ] 错误处理健壮

### 兼容性测试结果
- [ ] 深色/浅色主题兼容
- [ ] 移动端响应式正常
- [ ] 不同浏览器兼容

## 问题记录

如发现问题，请记录：
1. 问题描述
2. 复现步骤
3. 期望结果 vs 实际结果
4. 浏览器环境
5. 测试数据

## 总结

通过以上测试用例，可以全面验证付费Key检测功能是否满足以下要求：

✅ **核心逻辑正确**: 
- 免费key显示为"有效Key"
- 付费key显示为"付费Key"
- 状态分类准确

✅ **UI显示正确**:
- 视觉区分明确
- 标签页筛选准确
- 复制功能正确

✅ **性能稳定**:
- 批量处理正常
- 错误处理健壮
- 兼容性良好
